(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t():"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports["vue-flowy"]=t():e["vue-flowy"]=t()})("undefined"!==typeof self?self:this,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s="+xUi")}({"+xUi":function(e,t,r){"use strict";r.r(t);r("HrLf");var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"flowyChart",attrs:{id:e._uid}})},s=[];class i{constructor(){this.height=0,this.width=0}setSize(e,t){this.width=e,this.height=t}}class o{constructor(){this.x=0,this.y=0}}class a{constructor(){}setPadding({left:e=10,top:t=10,right:r=10,bottom:n=10}){this.padding={left:e,top:t,right:r,bottom:n}}setBorderRadius(e={rx:0,ry:0}){this.radius=e}setShape(e){this.shape=e}setBorder({left:e=0,top:t=0,right:r=0,bottom:n=0}){this.border={left:e,top:t,right:r,bottom:n}}}class h{constructor(e,t={}){this.label="",this.parent=null,this.children={},this.position=new o,this.size=new i,this.style=new a,this.rank=0,this.order=0,this.inEdges={},this.outEdges={},this.successors={},this.predecessors={},this.borders={},this.id=e,this.setOptions(t)}setOptions(e){e.label||(e.label=this.id),Object.assign(this,e)}}var d=r("NOtv"),c=r.n(d);const l=c()("layering");class u{constructor(e){this.graph=e,this.matrix=this.buildLayerMatrix()}buildLayerMatrix(){const e=[];return l("NODES FOR MATRIX is",Object.assign({},this.graph.nodes)),this.graph.nodes.forEach(t=>{e[t.rank]||(e[t.rank]=[]),e[t.rank][t.order]=t}),e}calculatePositions(){this._calculateYPositions(),this._calculateXPositions()}_calculateYPositions(){let e=0;this.matrix.forEach(t=>{const r=Math.max(...t.map(e=>{return e.size.height}));t.forEach(t=>{l("assigning y",t.id,e,r/2,e+r/2),t.position.y=e+r/2}),e+=r+this.graph.rankSep})}_calculateXPositions(){l("is",this.buildLayerMatrix());const e={};let t;const r=["u","d"],n=["l","r"];r.forEach(r=>{t="u"===r?this.matrix:Object.values(this.matrix).reverse(),n.forEach(n=>{"r"===n&&(t=t.map(e=>Object.values(e).reverse())),l("adjusted layering is",t);const s=this._verticalAlignment(t,r,n);let i=this._horizontalCompaction(t,s,"r"===n);if(l(r+n,i),"r"===n)for(const e in i)i[e]=-i[e];e[r+n]=i})}),l("xPositions finish",e);const s=this._findSmallestWidthAlignment(e);return l("smallestWidth is",s),this._alignCoordinates(e,s),this.graph.layout.balance(e)}_alignCoordinates(e,t){const r=Object.values(t),n=Math.min(...r),s=Math.max(...r),i=["u","d"],o=["l","r"];i.forEach(r=>{o.forEach(i=>{const o=r+i,a=e[o];if(a===t)return;const h=Object.values(a),d="l"===i?n-Math.min(...h):s-Math.max(...h);if(d){for(const e in a)a[e]+=d;e[o]=a}})})}_findSmallestWidthAlignment(e){let t=1/0,r={};return Object.values(e).forEach(e=>{let n=1/0,s=-1/0;Object.keys(e).forEach(t=>{const r=e[t],i=r-this.graph.getNode(t).size.width/2;i<n&&(n=i),i>s&&(s=i)});const i=s-n;i<t&&(t=i,r=e)}),r}_horizontalCompaction(e,t,r){l("horizontalCompaction",e,t,r);const n={},s=E.buildBlockGraph(e,t.root,r),i={};function o(e){i[e.id]||(i[e.id]=!0,n[e.id]=s.inEdges(e).reduce((e,t)=>{return o(t.from),Math.max(e,n[t.from.id]+(t.maxSep||0))},0))}return s.nodes.forEach(o),Object.keys(t.align).forEach(e=>{n[e]=n[t.root[e].id]}),n}_verticalAlignment(e,t,r){const n={},s={},i={};return e.forEach(e=>{e.forEach((e,t)=>{n[e.id]=e,s[e.id]=e,i[e.id]=t})}),l("objects after first step is",n,s,i),e.forEach(e=>{let r=-1;e.forEach(e=>{let o="u"===t?this.graph.getPredecessors(e):this.graph.getSuccessors(e);if(!o.length)return;o=this.graph.layout.sortByFunction(o,e=>i[e]);const a=(o.length-1)/2;for(let t=Math.floor(a),h=Math.ceil(a);t<=h;t++){const a=o[t];s[e.id].id===e.id&&r<i[a]&&(s[a]=e,s[e.id]=n[e.id]=n[a],r=i[a])}})}),{root:n,align:s}}}const p=c()("normalizer");class g{constructor(e){this.graph=e}normalize(){this.graph.dummyChain=[],p("EDGES",this.graph.edges),this.graph.edges.forEach(this._normalizeEdge,this)}_normalizeEdge(e){if(e.to.rank!==e.from.rank+1)for(let t=e.from.rank+1;t<e.to.rank;t++){e.points=[];let r=this.graph.addDummyNode("edge",{rank:e.from.rank},"_d");this.graph.setEdge(e.from.id,r.id,{weight:e.weight}),t===e.from.rank+1&&this.graph.dummyChain.push(r)}}}const f=c()("layout");class m{constructor(e){this.graph=e,this.normalizer=new g(this.graph),this.layering=new u(this.graph),this.runLayout(),f("new layout for graph",e)}runLayout(){this.makeSpaceForEdgeLabels(),this.createNestingGraph(),this.rank(),this.cleanupNestingGraph(),this.normalizeRanks(),this.assignRankMinMax(),this.normalizer.normalize(),this.order(),this.adjustCoordinateSystem(),this.layering.calculatePositions(),this.undoCoordinateSystem(),this.translateGraph()}makeSpaceForEdgeLabels(){this.graph.rankSep/=2,f(this.graph),this.graph.edges.forEach(e=>{f("making space for edge",e),e.minLen*=2,"c"!==e.labelPos.toLowerCase()&&("tb"===this.graph.rankDir||"bt"===this.graph.rankDir?e.size.width+=e.labelOffset:e.size.height+=e.labelOffset)})}createNestingGraph(){f("creating nesting graph"),this.graph.rootNode=this.graph.setNode("_root",{dummy:"root"});const e=this.treeDepths();f("depths",e);const t=Math.max(...Object.values(e))-1;this.graph.nodeRankFactor=2*t+1,this.graph.edges.forEach(e=>{e.minLen*=this.graph.nodeRankFactor});const r=this.graph.edges.reduce((e,t)=>e+t.weight,0);this.graph.getChildren().forEach(n=>{f("calling dfs with",this.graph.rootNode,this.graph.nodeRankFactor,r,t,e,n),this.dfs(this.graph.rootNode,r,t,e,n)}),f("edges after nesting graph",this.graph.edges.length)}cleanupNestingGraph(){this.graph.rootNode&&this.graph.removeNode(this.graph.rootNode.id),delete this.graph["rootNode"],this.graph.edges.forEach(e=>{e.nestingEdge&&this.graph.removeEdge(e.id)}),f("edges after cleanup nesting graph",this.graph.edges.length,this.graph.edges)}normalizeRanks(){const e=this.minRank();this.graph.nodes.forEach(t=>t.rank-=e)}assignRankMinMax(){let e=0;this.graph.nodes.forEach(t=>{t.borders.top&&t.borders.bottom&&(t.minRank=t.borders.top.rank,t.maxRank=t.borders.bottom.rank,e=Math.max(e,t.maxRank))}),this.graph.maxRank=e}treeDepths(){const e={};function t(r,n=1){const s=Object.values(r.children);f("children of",r,"are",s,". depth:",n),s.forEach(e=>{f("child",e),t(e,n+1)}),e[r.id]=n}return this.graph.getChildren().forEach(e=>{t(e)}),e}dfs(e,t,r,n,s){const i=Object.values(s.children);if(f("DFS: children of",s,i),!i.length)return void(s.id!==e.id&&this.graph.setEdge(e.id,s.id,{weight:0,minLen:this.graph.nodeRankFactor}));const o=this.addBorderNode("_bt"),a=this.addBorderNode("_bb");s.borders={top:o,bottom:a},this.graph.setParent(o.id,s.id),this.graph.setParent(a.id,s.id),i.forEach(i=>{this.dfs(e,t,r,n,i);const h=i.borders.top?i.borders.top:i,d=i.borders.bottom?i.borders.bottom:i,c=Object.keys(i.borders).length?t:2*t,l=h!==d?1:r-n[s.id]+1;this.graph.setEdge(o.id,h.id,{weight:c,minLen:l,nestingEdge:!0}),this.graph.setEdge(d.id,a.id,{weight:c,minLen:l,nestingEdge:!0})}),this.graph.getParent(s.id)||this.graph.setEdge(e.id,o.id,{weight:0,minLen:r+n[s.id]})}addBorderNode(e,t,r){const n={width:0,height:0};return t&&r&&(n.rank=t,n.order=r),this.graph.addDummyNode("border",n,e)}rank(){switch(this.graph.ranker){case"network-simplex":this.networkSimplexRanker();break;case"tight-tree":break;case"longest-path":break;default:this.networkSimplexRanker();break}}position(){this.positionY()}positionX(){this.layering.buildLayerMatrix()}positionY(){let e=0;this.layering.matrix.forEach(t=>{const r=Math.max(...t.map(e=>e.size.height));t.forEach(t=>{f("assigning y",t.id,e,r/2,e+r/2),t.position.y=e+r/2}),e+=r+this.graph.rankSep})}balance(e){for(const t in e.ul){const r=Object.values(Object.values(e)).map(e=>e[t]).sort();e.ul[t]=r[1]+r[2]/2}return e}networkSimplexRanker(){this.longestPath(),this.feasibleTree()}longestPath(){const e=this,t={};function r(n){if(t[n.id])return n.rank;t[n.id]=!0;const s=Math.min(...e.graph.outEdges(n).map(e=>{return r(e.to)-e.minLen})),i=s===1/0?0:s;return n.rank=i}this.graph.sources.forEach(r)}feasibleTree(){this.treeGraph=new E({directed:!1});const e=this.graph.nodeIds[0],t=this.graph.nodeIds.length;let r,n;this.treeGraph.setNode(e),f("start is",e,"size is",t);let s=0;while(this.tightTree()<t){if(r=this.findMinSlackEdge(),null===r)throw new Error("min slack edge is null!");if(n=this.treeGraph.hasNode(r.from.id)?this.slack(r):-this.slack(r),this.shiftRanks(n),s++,s>200)throw new Error("too many loops, breaking now!")}}tightTree(){const e=this,t=this.treeGraph;function r(n){f("nodeEdges",e.graph.nodeEdges(n)),e.graph.nodeEdges(n).forEach(s=>{f("nodeEdge for",n.id,s);const i=n.id===s.from.id?s.to:s.from;f("not hasNode",!t.hasNode(i.id),"not slack",!e.slack(s)),t.hasNode(i.id)||e.slack(s)||(f("adding node to tighttree",i),t.setNode(i.id),t.setEdge(n.id,i.id),r(i))})}return t.nodes.forEach(r),f("tightTree size is",t.nodeIds.length),t.nodeIds.length}findMinSlackEdge(){let e=null,t=1/0;return f("finding min slack edge"),this.graph.edges.forEach(r=>{if(this.treeGraph.hasNode(r.from.id)!==this.treeGraph.hasNode(r.to.id)){const n=this.slack(r);n<t&&(e=r,t=n)}}),e}slack(e){return f("calculating slack of",e,e.to.rank,e.from.rank,e.minLen),e.to.rank-e.from.rank-e.minLen}order(){this.maxRank();const e=this.initOrder();f("LAYERING",e),this.assignOrder(e)}buildLayerGraph(e,t){const r=new E({compound:!0});r.rootNode=r.setNode("_root",{dummy:"root"}),this.graph.nodes.forEach(n=>{const s=n.parent;if(!n.minRank||!n.maxRank)throw new Error("minRank or maxRank not defined!");if(n.rank===e||n.minRank<=e&&e<=n.maxRank){r.setNode(n.id);r.setParent(n.id,s?s.id:r.rootNode?r.rootNode.id:"");let i=[];"in"===t?i=this.graph.inEdges(n):"out"===t&&(i=this.graph.outEdges(n)),i.forEach(e=>{const t=e.from.id===n.id?e.to:e.from,s=r.getEdge(t.id,n.id),i=e?s.weight:0;r.setEdge(t.id,n.id,{weight:e.weight+i})}),n.minRank&&n.borders.left&&n.borders.right&&r.setNode(n.id,{borders:{left:{[e]:n.borders.left[e]},right:{[e]:n.borders.right[e]}}})}})}buildLayerGraphs(e,t){return e.map(e=>this.buildLayerGraph(e,t))}initOrder(){const e=this,t={},r=this.graph.nodes.filter(e=>!this.graph.getChildren(e.id).length),n=(this.maxRank(r),[]);function s(r){t[r.id]||(t[r.id]=!0,n[r.rank]||(n[r.rank]=[]),n[r.rank].push(r),e.graph.getSuccessors(r).forEach(t=>{s(e.graph.getNode(t))}))}function i(e,t){return e.rank<t.rank?-1:e.rank>t.rank?1:0}const o=r.sort(i);return o.forEach(s,this),n}assignOrder(e){e.forEach(e=>{e.forEach((e,t)=>{e.order=t})})}adjustCoordinateSystem(){"lr"!==this.graph.rankDir&&"rl"!==this.graph.rankDir||this.swapWidthHeight()}undoCoordinateSystem(){"bt"===this.graph.rankDir||this.graph.rankDir,"lr"!==this.graph.rankDir&&"rl"!==this.graph.rankDir||(this.swapXY(),this.swapWidthHeight())}_swapWidthHeightOne(e){const t=e.size.width;e.size.width=e.size.height,e.size.height=t}swapWidthHeight(){this.graph.nodes.forEach(this._swapWidthHeightOne),this.graph.edges.forEach(this._swapWidthHeightOne)}_swapXYOne(e){const t=e.position.x;e.position.x=e.position.y,f("y before",e.position.y,"after",t),e.position.y=t,f("now",{x:e.position.x,y:e.position.y})}swapXY(){this.graph.nodes.forEach(this._swapXYOne),this.graph.edges.forEach(e=>{e.points.forEach(this._swapXYOne),e.position.x&&this._swapXYOne(e)})}maxRank(e=this.graph.nodes){return e.reduce((e,t)=>{return t.rank>e?t.rank:e},-1/0)}minRank(e=this.graph.nodes){return e.reduce((e,t)=>{return t.rank<e?t.rank:e},1/0)}shiftRanks(e){if(!this.treeGraph)throw new Error("treeGraph is not defined!");this.treeGraph.nodes.forEach(t=>{t.rank+=e})}translateGraph(){let e=1/0,t=0,r=1/0,n=0;const s=this.graph.marginX||0,i=this.graph.marginY||0;function o(s){const i=s.position.x||0,o=s.position.y||0,a=s.size.width||0,h=s.size.height||0;e=Math.min(e,i-a/2),t=Math.max(t,i+a/2),r=Math.min(r,o-h/2),n=Math.max(n,o+h/2)}this.graph.nodes.forEach(o),this.graph.edges.forEach(e=>{e.position.x&&o(e)}),e-=s,r-=i,this.graph.nodes.forEach(t=>{t.position.x-=e,t.position.y-=r}),this.graph.edges.forEach(t=>{t.points.forEach(t=>{t.position.x-=e,t.position.y-=r}),t.position.x&&(t.position.x-=e),t.position.y&&(t.position.y-=r)}),this.graph.size.width=t-e+s,this.graph.size.height=n-r+i}sortBy(e,t){function r(e,r){return e[t]<r[t]?-1:e[t]>r[t]?1:0}return e.sort(r)}sortByFunction(e,t){function r(e,r){return t(e)<t(r)?-1:t(e)>t(r)?1:0}return e.sort(r)}}const y="\0",b="";class C{constructor(e,t,r,n){this.order=0,this.points=[],this.data={},this.position=new o,this.size=new i,this.minLen=1,this.weight=1,this.labelOffset=10,this.labelPos="r",this.nestingEdge=!1,this.id=e,this.from=t,this.to=r,this.setOptions(n)}static generateId(e,t,r=!1,n){if(!r&&e>t){const r=e;e=t,t=r}return e+b+t+b+(n||y)}setOptions(e={}){Object.assign(this,e)}}const w=c()("graph"),v="\0";class E{constructor(e={}){this._nodes={},this._edges={},this.layout=new m(this),this.size=new i,this.style=new a,this.nodeRankFactor=0,this.compound=!1,this.multiGraph=!1,this.directed=!0,this.rankDir="tb",this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.marginX=20,this.marginY=20,this.randomId=1,this.dummyChain=[],this.rankSep=50,this.edgeSep=20,this.nodeSep=50,this.ranker="network-simplex",Object.assign(this,e),this.rankDir=this.rankDir.toLowerCase()}setNode(e,t={}){return this._nodes[e]?(t&&this._nodes[e].setOptions(t),this._nodes[e]):(w("creating node",e,t),this._nodes[e]=new h(e,t),this._nodes[e])}removeNode(e){w("removing node id",e);const t=this._nodes[e];t&&(Object.keys(t.inEdges).forEach(this.removeEdge,this),Object.keys(t.outEdges[e]).forEach(this.removeEdge,this),delete this._nodes[e])}setEdge(e,t,r={}){w("setting edge",e,t,r);const n=C.generateId(e,t,this.directed,r.name);if(this._edges[n])return r&&this._edges[n].setOptions(r),this;const s=this.setNode(e),i=this.setNode(t),o=new C(n,s,i,r);return this._edges[n]=o,s.outEdges[n]=o,i.inEdges[n]=o,this}removeEdge(e){if(w("removing edge",e),!this._edges[e])return void w("edge",e,"does not exist. returning...");this._edges[e];delete this._edges[e]}addDummyNode(e,t,r){return r+=this.randomId++,t.dummy=e,this.setNode(r,t)}getNode(e){return this._nodes[e]}getEdge(e,t){return this._edges[C.generateId(e,t,this.directed)]}getChildren(e){return e?this.compound?Object.values(this._nodes[e].children):[]:this.nodes}getParent(e){if(!this.compound)return null;const t=this._nodes[e].parent;return null!==t&&t.id!==v?t:null}getPredecessors(e){return e.predecessors?Object.keys(e.predecessors):[]}getSuccessors(e){return e.successors?Object.keys(e.successors):[]}setParent(e,t){if(!this.compound)throw new Error("Cannot set parent in a non-compound graph");if(""===t)throw new Error("Cannot set parent id to an empty id! (parentId is an empty string)");let r=t;while(r){const n=this.getParent(r);if(n){if(r===e)throw new Error("Setting "+t+" as parent of "+e+" would create a cycle");r=n.id}else r=null}let n=this.setNode(t),s=this.setNode(e);this._nodes[e].parent=n,n.children[e]=s}nodeEdges(e,t){const r=this.inEdges(e,t);return r?r.concat(this.outEdges(e,t)):[]}isSubgraph(e){return 0!==this.getChildren(e).length}doLayout(){w("layouting graph"),this.layout=new m(this)}hasNode(e){return this._nodes[e]}get nodes(){return Object.values(this._nodes)}get edges(){return Object.values(this._edges)}get sources(){return this.nodes.filter(e=>{return 0===Object.keys(e.inEdges).length})}inEdges(e,t){if(!e.inEdges)return[];const r=Object.values(e.inEdges);return t?r.filter(e=>e.from.id===t.id):r}outEdges(e,t){if(!e.outEdges)return[];const r=Object.values(e.outEdges);return t?r.filter(e=>e.to.id===t.id):r}get nodeIds(){return Object.keys(this._nodes)}static buildBlockGraph(e,t,r){const n=new E;return e.forEach(e=>{let s;e.forEach(e=>{if(n.setNode(t[e.id].id),!s)return void(s=e);n.getEdge(t[s.id].id,t[e.id].id);w("CHECK PREVMAX FROM STABLE"),n.setEdge(t[s.id].id,t[e.id].id,{maxSep:Math.max(n.sep(r,e,s),0)}),s=e})}),n}sep(e,t,r){let n,s=0;return s+=t.size.width/2,w("CHECK LABEL POS"),n&&(s+=e?n:-n),n=0,s+=(t.dummy?this.edgeSep:this.nodeSep)/2,s+=(r.dummy?this.edgeSep:this.nodeSep)/2,s+=r.size.width/2,n&&(s+=e?n:-n),n=0,s}}class k{constructor(e){e instanceof SVGGraphicsElement?this.node=e:this.node=document.createElementNS("http://www.w3.org/2000/svg",e)}append(e){return e instanceof k||(e=new k(e)),this.node.appendChild(e.node),e}attr(e,t){return this.node.setAttribute(e,t),this}select(e){const t=this.node.querySelector(e);if(t instanceof SVGGraphicsElement)return new k(t);if(t)throw new TypeError('The selected element is not of type "SVGGraphicsElement"');return null}selectAll(e){const t=this.node.querySelectorAll(e);if(t instanceof SVGGraphicsElement)return Array.from(t).map(e=>new k(e));if(t)throw new TypeError('The selected element is not of type "SVGGraphicsElement"');return null}text(e){const t=document.createTextNode(e);return this.node.appendChild(t),this}addClass(e){return this.node.classList.add(e),this}}class x{constructor(e,t,r){this.shape=this[e](t,r)}rect(e,{rx:t="0",ry:r="0"}){return new k("rect").attr("rx",t).attr("ry",r).attr("x",(-e.width/2).toString()).attr("y",(-e.height/2).toString()).attr("width",e.width.toString()).attr("height",e.height.toString())}}class F{constructor(e){this.group=new k("g"),this.labelData=e,this.textLabel()}textLabel(){this.group.append("text").text(this.labelData.label)}}class S{constructor(e){this.graph=e}render(e){console.log("rendering",e,this.graph);this.createOrSelectGroup(e,"edgePaths"),this.createEdgeLabels(this.createOrSelectGroup(e,"edgeLabels"));this.createNodes(this.createOrSelectGroup(e,"nodes")),this.graph.doLayout();let t=1e3,r=1e3,n=-1e3,s=-1e3;this.graph.nodes.forEach(e=>{t=Math.min(t,e.position.x-e.size.width/2),r=Math.min(r,e.position.y-e.size.height/2),n=Math.max(n,e.position.x+e.size.width/2),s=Math.max(s,e.position.y+e.size.height/2)}),this.graph.edges.forEach(e=>{e.position.x&&e.position.y&&(t=Math.min(t,e.position.x-e.size.width/2),r=Math.min(r,e.position.y-e.size.height/2),n=Math.max(n,e.position.x+e.size.width/2),s=Math.max(s,e.position.y+e.size.height/2));const i=e.points.slice(1,e.points.length-1);for(let o=0;o<i.length;o++){const e=i[o];t=Math.min(t,e.x),r=Math.min(r,e.y),n=Math.max(n,e.x),s=Math.max(s,e.y)}}),this.graph.minX=t,this.graph.minY=r,this.graph.maxX=n,this.graph.maxY=s,console.log("GRAPH",this.graph),this.positionNodes()}createNodes(e){this.graph.nodeIds.filter(e=>{return!this.graph.isSubgraph(e)});this.graph.nodes.forEach(t=>{const r=e.append("g").addClass("node"),n=r.append("g").addClass("label"),s=n.append(new F({label:t.label}).group),i=s.node.getBBox();if(t.style.padding&&(i.width+=t.style.padding.left+t.style.padding.right,i.height+=t.style.padding.top+t.style.padding.bottom,n.attr("transform","translate("+(t.style.padding.left-t.style.padding.right)/2+","+(t.style.padding.top-t.style.padding.bottom)/2+")")),!t.style.shape)throw new Error("no shape is defined!");const o=r.append(new x(t.style.shape,i,{width:t.size.width,height:t.size.height}).shape),a=o.node.getBBox();t.size.setSize(a.width,a.height),r.append(n),t.svgGroup=r})}createEdgeLabels(e){e.selectAll("g.edgeLabel");this.graph.edges.forEach(t=>{const r=e.append("g").addClass("edgeLabel"),n=r.append("g").addClass("label"),s=n.append(new F({label:t.label||""}).group),i=s.node.getBBox();t.size.width=t.size.width||i.width,t.size.height=t.size.height||i.height})}positionNodes(){console.log("position nodes",this.graph.nodes,"with edges",this.graph.edges),this.graph.nodes.forEach(e=>{e.svgGroup&&e.svgGroup.attr("transform","translate("+(e.position.x||0)+","+(e.position.y||0)+")")})}createOrSelectGroup(e,t){return e.select("g."+t)||e.append("g").addClass(t)}}class _{constructor(e,t){this.edges=[],this.id=e,this.options=t}leadsTo(e,t){return this.edges.push({otherId:e.id,options:t}),e}}class O{constructor(e={}){this.elements=[],localStorage.debug="layout,normalizer,layering"}addElement(e,t){const r=new _(e,t);return this.elements.push(r),r}render(e){const t=new k("svg");t.node.id="f"+e.id,e.appendChild(t.node);const r=t.append("g"),n=new E({multiGraph:!0,compound:!0,rankDir:"LR",marginX:20,marginY:20});for(const i in this.elements){const e=this.elements[i];n.setNode(e.id,e.options)}for(const i of n.nodes)i.style.radius={rx:5,ry:5};for(const i in this.elements){const e=this.elements[i];for(const t in e.edges){const r=e.edges[t];n.setEdge(e.id,r.otherId,r.options)}}const s=new S(n);s.render(r)}}var N={name:"VueFlowy",props:{chart:{type:O,required:!0}},data(){return{chartElement:null}},watch:{"chart.elements":function(e,t){this.chart.render(this.chartElement)}},mounted(){this.chartElement=document.getElementById(this._uid)}},M=N;r("E1aB");function j(e,t,r,n,s,i,o,a){var h,d="function"===typeof e?e.options:e;if(t&&(d.render=t,d.staticRenderFns=r,d._compiled=!0),n&&(d.functional=!0),i&&(d._scopeId="data-v-"+i),o?(h=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),s&&s.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(o)},d._ssrRegister=h):s&&(h=a?function(){s.call(this,this.$root.$options.shadowRoot)}:s),h)if(d.functional){d._injectStyles=h;var c=d.render;d.render=function(e,t){return h.call(t),c(e,t)}}else{var l=d.beforeCreate;d.beforeCreate=l?[].concat(l,h):[h]}return{exports:e,options:d}}var z=j(M,n,s,!1,null,null,null),R=z.exports;const L={install(e){e.component(R.name,R)}};var G=L;r.d(t,"FlowChart",function(){return O});t["default"]=G},"1k3w":function(e,t,r){var n=r("DOny");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var s=r("SZ7m").default;s("6b43ab32",n,!0,{sourceMap:!1,shadowMode:!1})},"33yf":function(e,t,r){(function(e){function r(e,t){for(var r=0,n=e.length-1;n>=0;n--){var s=e[n];"."===s?e.splice(n,1):".."===s?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}var n=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,s=function(e){return n.exec(e).slice(1)};function i(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}t.resolve=function(){for(var t="",n=!1,s=arguments.length-1;s>=-1&&!n;s--){var o=s>=0?arguments[s]:e.cwd();if("string"!==typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(t=o+"/"+t,n="/"===o.charAt(0))}return t=r(i(t.split("/"),function(e){return!!e}),!n).join("/"),(n?"/":"")+t||"."},t.normalize=function(e){var n=t.isAbsolute(e),s="/"===o(e,-1);return e=r(i(e.split("/"),function(e){return!!e}),!n).join("/"),e||n||(e="."),e&&s&&(e+="/"),(n?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(i(e,function(e,t){if("string"!==typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},t.relative=function(e,r){function n(e){for(var t=0;t<e.length;t++)if(""!==e[t])break;for(var r=e.length-1;r>=0;r--)if(""!==e[r])break;return t>r?[]:e.slice(t,r-t+1)}e=t.resolve(e).substr(1),r=t.resolve(r).substr(1);for(var s=n(e.split("/")),i=n(r.split("/")),o=Math.min(s.length,i.length),a=o,h=0;h<o;h++)if(s[h]!==i[h]){a=h;break}var d=[];for(h=a;h<s.length;h++)d.push("..");return d=d.concat(i.slice(a)),d.join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){var t=s(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},t.basename=function(e,t){var r=s(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},t.extname=function(e){return s(e)[3]};var o="b"==="ab".substr(-1)?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)}}).call(this,r("Q2Ig"))},DOny:function(e,t,r){t=e.exports=r("I1BE")(!1),t.push([e.i,".flowyChart svg{display:block;margin:0 auto}.flowyChart .node rect{stroke:#999;fill:#fff;stroke-width:1.5px}.flowyChart .edgePath path{stroke:#333;stroke-width:1.5px}",""])},E1aB:function(e,t,r){"use strict";var n=r("1k3w"),s=r.n(n);s.a},FGiv:function(e,t){var r=1e3,n=60*r,s=60*n,i=24*s,o=365.25*i;function a(e){if(e=String(e),!(e.length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var a=parseFloat(t[1]),h=(t[2]||"ms").toLowerCase();switch(h){case"years":case"year":case"yrs":case"yr":case"y":return a*o;case"days":case"day":case"d":return a*i;case"hours":case"hour":case"hrs":case"hr":case"h":return a*s;case"minutes":case"minute":case"mins":case"min":case"m":return a*n;case"seconds":case"second":case"secs":case"sec":case"s":return a*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}function h(e){return e>=i?Math.round(e/i)+"d":e>=s?Math.round(e/s)+"h":e>=n?Math.round(e/n)+"m":e>=r?Math.round(e/r)+"s":e+"ms"}function d(e){return c(e,i,"day")||c(e,s,"hour")||c(e,n,"minute")||c(e,r,"second")||e+" ms"}function c(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}e.exports=function(e,t){t=t||{};var r=typeof e;if("string"===r&&e.length>0)return a(e);if("number"===r&&!1===isNaN(e))return t.long?d(e):h(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},HrLf:function(e,t,r){if("undefined"!==typeof window){let e;(e=window.document.currentScript)&&(e=e.src.match(/(.+\/)[^/]+\.js$/))&&(r.p=e[1])}},I1BE:function(e,t){function r(e,t){var r=e[1]||"",s=e[3];if(!s)return r;if(t&&"function"===typeof btoa){var i=n(s),o=s.sources.map(function(e){return"/*# sourceURL="+s.sourceRoot+e+" */"});return[r].concat(o).concat([i]).join("\n")}return[r].join("\n")}function n(e){var t=btoa(unescape(encodeURIComponent(JSON.stringify(e)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,"+t;return"/*# "+r+" */"}e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n=r(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n}).join("")},t.i=function(e,r){"string"===typeof e&&(e=[[null,e,""]]);for(var n={},s=0;s<this.length;s++){var i=this[s][0];"number"===typeof i&&(n[i]=!0)}for(s=0;s<e.length;s++){var o=e[s];"number"===typeof o[0]&&n[o[0]]||(r&&!o[2]?o[2]=r:r&&(o[2]="("+o[2]+") and ("+r+")"),t.push(o))}},t}},NOtv:function(e,t,r){(function(n){function s(){return!("undefined"===typeof window||!window.process||"renderer"!==window.process.type)||("undefined"===typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function i(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),r){var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var s=0,i=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(s++,"%c"===e&&(i=s))}),e.splice(i,0,n)}}function o(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}}function h(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!==typeof n&&"env"in n&&(e=Object({NODE_ENV:"production",BASE_URL:"/"}).DEBUG),e}function d(){try{return window.localStorage}catch(e){}}t=e.exports=r("lv48"),t.log=o,t.formatArgs=i,t.save=a,t.load=h,t.useColors=s,t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:d(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(h())}).call(this,r("Q2Ig"))},Q2Ig:function(e,t,r){t.nextTick=function(e){setTimeout(e,0)},t.platform=t.arch=t.execPath=t.title="browser",t.pid=1,t.browser=!0,t.env={},t.argv=[],t.binding=function(e){throw new Error("No such module. (Possibly not yet loaded)")},function(){var e,n="/";t.cwd=function(){return n},t.chdir=function(t){e||(e=r("33yf")),n=e.resolve(t,n)}}(),t.exit=t.kill=t.umask=t.dlopen=t.uptime=t.memoryUsage=t.uvCounters=function(){},t.features={}},SZ7m:function(e,t,r){"use strict";function n(e,t){for(var r=[],n={},s=0;s<t.length;s++){var i=t[s],o=i[0],a=i[1],h=i[2],d=i[3],c={id:e+":"+s,css:a,media:h,sourceMap:d};n[o]?n[o].parts.push(c):r.push(n[o]={id:o,parts:[c]})}return r}r.r(t),r.d(t,"default",function(){return g});var s="undefined"!==typeof document;if("undefined"!==typeof DEBUG&&DEBUG&&!s)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var i={},o=s&&(document.head||document.getElementsByTagName("head")[0]),a=null,h=0,d=!1,c=function(){},l=null,u="data-vue-ssr-id",p="undefined"!==typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function g(e,t,r,s){d=r,l=s||{};var o=n(e,t);return f(o),function(t){for(var r=[],s=0;s<o.length;s++){var a=o[s],h=i[a.id];h.refs--,r.push(h)}t?(o=n(e,t),f(o)):o=[];for(s=0;s<r.length;s++){h=r[s];if(0===h.refs){for(var d=0;d<h.parts.length;d++)h.parts[d]();delete i[h.id]}}}}function f(e){for(var t=0;t<e.length;t++){var r=e[t],n=i[r.id];if(n){n.refs++;for(var s=0;s<n.parts.length;s++)n.parts[s](r.parts[s]);for(;s<r.parts.length;s++)n.parts.push(y(r.parts[s]));n.parts.length>r.parts.length&&(n.parts.length=r.parts.length)}else{var o=[];for(s=0;s<r.parts.length;s++)o.push(y(r.parts[s]));i[r.id]={id:r.id,refs:1,parts:o}}}}function m(){var e=document.createElement("style");return e.type="text/css",o.appendChild(e),e}function y(e){var t,r,n=document.querySelector("style["+u+'~="'+e.id+'"]');if(n){if(d)return c;n.parentNode.removeChild(n)}if(p){var s=h++;n=a||(a=m()),t=C.bind(null,n,s,!1),r=C.bind(null,n,s,!0)}else n=m(),t=w.bind(null,n),r=function(){n.parentNode.removeChild(n)};return t(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap)return;t(e=n)}else r()}}var b=function(){var e=[];return function(t,r){return e[t]=r,e.filter(Boolean).join("\n")}}();function C(e,t,r,n){var s=r?"":n.css;if(e.styleSheet)e.styleSheet.cssText=b(t,s);else{var i=document.createTextNode(s),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(i,o[t]):e.appendChild(i)}}function w(e,t){var r=t.css,n=t.media,s=t.sourceMap;if(n&&e.setAttribute("media",n),l.ssrId&&e.setAttribute(u,t.id),s&&(r+="\n/*# sourceURL="+s.sources[0]+" */",r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),e.styleSheet)e.styleSheet.cssText=r;else{while(e.firstChild)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}},lv48:function(e,t,r){function n(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}function s(e){var r;function s(){if(s.enabled){var e=s,n=+new Date,i=n-(r||n);e.diff=i,e.prev=r,e.curr=n,r=n;for(var o=new Array(arguments.length),a=0;a<o.length;a++)o[a]=arguments[a];o[0]=t.coerce(o[0]),"string"!==typeof o[0]&&o.unshift("%O");var h=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(r,n){if("%%"===r)return r;h++;var s=t.formatters[n];if("function"===typeof s){var i=o[h];r=s.call(e,i),o.splice(h,1),h--}return r}),t.formatArgs.call(e,o);var d=s.log||t.log||console.log.bind(console);d.apply(e,o)}}return s.namespace=e,s.enabled=t.enabled(e),s.useColors=t.useColors(),s.color=n(e),s.destroy=i,"function"===typeof t.init&&t.init(s),t.instances.push(s),s}function i(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}function o(e){var r;t.save(e),t.names=[],t.skips=[];var n=("string"===typeof e?e:"").split(/[\s,]+/),s=n.length;for(r=0;r<s;r++)n[r]&&(e=n[r].replace(/\*/g,".*?"),"-"===e[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(r=0;r<t.instances.length;r++){var i=t.instances[r];i.enabled=t.enabled(i.namespace)}}function a(){t.enable("")}function h(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1}function d(e){return e instanceof Error?e.stack||e.message:e}t=e.exports=s.debug=s["default"]=s,t.coerce=d,t.disable=a,t.enable=o,t.enabled=h,t.humanize=r("FGiv"),t.instances=[],t.names=[],t.skips=[],t.formatters={}}})["default"]});
//# sourceMappingURL=vue-flowy.umd.min.js.map