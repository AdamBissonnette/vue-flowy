(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e():"function"===typeof define&&define.amd?define([],e):"object"===typeof exports?exports["vue-flowy"]=e():t["vue-flowy"]=e()})(window,function(){return function(t){var e={};function s(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,s),r.l=!0,r.exports}return s.m=t,s.c=e,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},s.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s="+xUi")}({"+xUi":function(t,e,s){"use strict";s.r(e);s("HrLf");var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"flowyChart",attrs:{id:t._uid}})},r=[];class o{constructor(t,e){this.defaults={paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,rx:0,ry:0,shape:"rect"},this.id=t,this.setOptions(e)}setOptions(t={}){t.label||(t.label=this.id),Object.assign(this,this.defaults,t)}setDefaults(){}}class i{constructor(t){this.graph=t,this.runLayout(),console.log("new layout for graph",t)}runLayout(){this.position()}makeSpaceForEdgeLabels(){this.graph.rankSep/=2,this.graph.edges.forEach(t=>{t.minLen*=2,"c"!==t.labelPos.toLowerCase()&&("TB"===this.graph.rankDir||"BT"===this.graph.rankDir?t.width+=t.labelOffset:t.height+=t.labelOffset)})}position(){this.positionY()}positionY(){this.buildLayerMatrix()}buildLayerMatrix(){const t=Math.max(...this.graph.nodes.map(t=>{const e=t.rank;if(e)return e}));console.log("max",t)}}const a="\0",d="",c={};class h{constructor(t,e,s,n){this.id=t,this.from=e,this.to=s,this.setOptions(n)}static generateId(t,e,s=!1){if(!s&&t>e){const s=t;t=e,e=s}return t+d+e+d+a}setOptions(t){Object.assign(this,c,t)}}const l="\0";class u{constructor({directed:t=!0,multiGraph:e=!1,compound:s=!1,rankDir:n="LR",marginX:r=20,marginY:o=20}){this.defaultNodeData={paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,rx:0,ry:0,shape:"rect"},this._nodes={},this._edges={},!0===this.compound&&(this.parent={},this.children={},this.children[l]={}),this.in={},this.preds={},this.out={},this.sucs={},this.edgeObjs={}}setNode(t,e){return console.log("setting node",t,e),this._nodes[t]?(e&&this._nodes[t].setOptions(e),this):(this._nodes[t]=new o(t,e),!0===this.compound&&(this.parent[t]=l,this.children[t]={},this.children[l][t]=!0),this.in[t]={},this.preds[t]={},this.out[t]={},this.sucs[t]={},this)}setEdge(t,e,s){console.log("setting edge",t,e,s);const n=h.generateId(t,e,this.directed);if(this._edges[n])return s&&this._edges[n].setOptions(s),this;this.setNode(t),this.setNode(e);const r=new h(n,t,e,s);return this._edges[n]=r,this.out[t][n]=r,this.in[e][n]=r,this}getNode(t){return this._nodes[t]}getChildren(t){if(t||(t=l),!this.compound)return t===l?this.nodes:[];{const e=this.children[t];if(e)return Object.keys(e)}}isSubgraph(t){return 0!==this.getChildren(t).length}layout(){console.log("layouting graph");new i(this)}get nodes(){return Object.values(this._nodes)}get nodeIds(){return Object.keys(this._nodes)}}class p{constructor(t){this.node=document.createElementNS("http://www.w3.org/2000/svg",t)}append(t){return t instanceof p||(console.log("creating element out of",t),t=new p(t)),this.node.appendChild(t.node),t}attr(t,e){return this.node.setAttribute(t,e),this}select(t){const e=this.node.querySelector(t);return e?new p(e):null}selectAll(t){const e=this.node.querySelectorAll(t);return e?Array.from(e).map(t=>new p(t)):null}text(t){const e=document.createTextNode(t);return this.node.appendChild(e),this}addClass(t){return this.node.classList.add(t),this}}class g{constructor(t,e,s){this.shape=this[t](e,s)}rect(t,e){return new p("rect").attr("rx",e.rx).attr("ry",e.ry).attr("x",-t.width/2).attr("y",-t.height/2).attr("width",t.width).attr("height",t.height).attr("rx",e.rx)}}class f{constructor(t){this.group=new p("g"),this.labelData=t,this.textLabel()}textLabel(){this.group.append("text").text(this.labelData.label)}}class m{constructor(t){this.graph=t}render(t){this.createOrSelectGroup(t,"edgePaths"),this.createEdgeLabels(this.createOrSelectGroup(t,"edgeLabels"),this.graph),this.createNodes(this.createOrSelectGroup(t,"nodes"),this.graph)}createNodes(t,e){console.log("createNodes selection is",t,"graph is",e);e.nodeIds.filter(t=>{return!e.isSubgraph(t)});e.nodes.forEach(e=>{console.log("adding node",e);const s=new p("g").addClass("label"),n=s.append(new f({label:e.label}).group),r=n.node.getBBox(),o=t.append("g").addClass("node");o.append(new g(e.shape,r,e).shape);o.append(s)})}createLabel(t){}createEdgeLabels(t,e){let s=t.selectAll("g.edgeLabel");console.log(s),s.forEach(t=>{const e=SvgGenerator.create("g");e.classList.add("edgeLabel"),t.classList.add("update"),t.appendChild(e)})}createOrSelectGroup(t,e){return t.select("g."+e)||t.append("g").addClass(e)}}class b{constructor(t,e){this.id=t,this.options=e,this.edges=[]}leadsTo(t,e){return this.edges.push({otherId:t.id,options:e}),t}}class w{constructor(t){this.elements=[]}addElement(t,e){const s=new b(t,e);return this.elements.push(s),s}render(t){const e=new p("svg");e.node.id="f"+t.id,t.appendChild(e.node);const s=e.append("g"),n=new u({multiGraph:!0,compound:!0});for(const o in this.elements){const t=this.elements[o];n.setNode(t.id,t.options)}for(const o of n.nodes)o.rx=o.ry=5;for(const o in this.elements){const t=this.elements[o];for(const e in t.edges){const s=t.edges[e];n.setEdge(t.id,s.otherId,s.options)}}const r=new m(n);r.render(s)}}var y={name:"VueFlowy",props:{chart:{type:w,required:!0}},data(){return{chartElement:null}},watch:{"chart.elements":function(t,e){this.chart.render(this.chartElement)}},mounted(){this.chartElement=document.getElementById(this._uid)}},_=y;s("E1aB");function x(t,e,s,n,r,o,i,a){var d,c="function"===typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=s,c._compiled=!0),n&&(c.functional=!0),o&&(c._scopeId="data-v-"+o),i?(d=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),r&&r.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(i)},c._ssrRegister=d):r&&(d=a?function(){r.call(this,this.$root.$options.shadowRoot)}:r),d)if(c.functional){c._injectStyles=d;var h=c.render;c.render=function(t,e){return d.call(e),h(t,e)}}else{var l=c.beforeCreate;c.beforeCreate=l?[].concat(l,d):[d]}return{exports:t,options:c}}var v=x(_,n,r,!1,null,null,null),O=v.exports;const L={install:t=>{t.component(O.name,O)}};O.install=L.install;var C={VueFlowy:O,FlowChart:w};e["default"]=C},E1aB:function(t,e,s){"use strict";var n=s("yF/8"),r=s.n(n);r.a},HrLf:function(t,e,s){if("undefined"!==typeof window){let t;(t=window.document.currentScript)&&(t=t.src.match(/(.+\/)[^/]+\.js$/))&&(s.p=t[1])}},"yF/8":function(t,e,s){}})["default"]});
//# sourceMappingURL=vue-flowy.umd.min.js.map